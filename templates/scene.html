<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>场景页面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        h1, h2, h3, p, ul {
            margin: 0;
            padding: 0;
            font-size: 16px;
            text-align: left;
        }
        a {
            display: inline-block;
            margin-top: 10px;
            text-decoration: none;
            color: #0066cc;
        }
        a:hover {
            text-decoration: underline;
            color: #003366;
        }
    </style>
</head>
<body>
    {% if player.last_chat_message %}
        <div style="background-color: #f0f0f0; padding: 10px; margin-bottom: 20px;">
            【私聊】{{ player.last_chat_message.sender }}对你说：{{ player.last_chat_message.content }}
        </div>
    {% endif %}
    <a href="{{ url_for('scene') }}" class="refresh-btn">刷新</a>
    <a href="{{ url_for('shop') }}">商城</a>

    <h1>{{ location.name }}（{{ location.area_name }}）</h1>

    <div>
        {% if location.north_exit %}
            北:↑ <a href="{{ url_for('move', direction='north') }}">{{ locations[location.north_exit].name }}</a><br>
        {% endif %}
        
        {% if location.west_exit or location.east_exit %}
            {% if location.west_exit %}
                西:← <a href="{{ url_for('move', direction='west') }}">{{ locations[location.west_exit].name }}</a>
            {% endif %}
            {% if location.east_exit %}
                东:→ <a href="{{ url_for('move', direction='east') }}">{{ locations[location.east_exit].name }}</a>
            {% endif %}
            <br>
        {% endif %}
        
        {% if location.south_exit %}
            南:↓ <a href="{{ url_for('move', direction='south') }}">{{ locations[location.south_exit].name }}</a>
        {% endif %}
    
    </div>

    <div>
        怪物：<a href="{{ url_for('battle') }}">{{ monster.name }}({{ monster.level }}级)</a>
    </div>

    <div>
        {% if location.ground_items %}
            地上物品：
            {% for item_id in location.ground_items %}
                <a href="{{ url_for('pickup_item', item_id=item_id) }}">
                    {{ Item.load_items()[item_id].name }}
                </a>
            {% endfor %}
        {% endif %}
    </div>

    <div>
        <p>玩家：{% if other_players %}
            {% for other_player in other_players %}
                <a href="{{ url_for('view_player', username=other_player.username) }}">{{ other_player.name }}</a>{% if not loop.last %},{% endif %}
            {% endfor %}
        {% else %}
            无
        {% endif %}</p>
    </div>

    <div style="margin-top: 20px;">
        <a href="{{ url_for('character') }}">角色</a>
        <a href="{{ url_for('inventory') }}">背包</a>
        <a href="{{ url_for('chat') }}">聊天</a>
    </div>

    <div style="margin-top: 20px;">
        三国时间：{{ now.strftime('%Y-%m-%d %H:%M:%S') }}
    </div>

    <div style="margin-top: 20px;">
        <a href="{{ url_for('logout') }}">退出游戏</a>
    </div>
</body>
</html>
